/*! BookStore 2018-03-01 */
var routerApp=angular.module("routerApp",["ui.router","ngGrid","BookListModule","BookDetailModule"]);routerApp.run(function(a,b,c){a.$state=b,a.$stateParams=c}),routerApp.config(function(a,b){b.otherwise("/index"),a.state("index",{url:"/index",views:{"":{templateUrl:"tpls/home.html"},"main@index":{templateUrl:"tpls/loginForm.html"}}}).state("booklist",{url:"/{bookType:[0-9]{1,4}}",views:{"":{templateUrl:"tpls/bookList.html"},"booktype@booklist":{templateUrl:"tpls/bookType.html"},"bookgrid@booklist":{templateUrl:"tpls/bookGrid.html"}}}).state("addbook",{url:"/addbook",templateUrl:"tpls/addBookForm.html"}).state("bookdetail",{url:"/bookdetail/:bookType/:bookId",templateUrl:"tpls/bookDetail.html"})});var bookListModule=angular.module("BookListModule",[]);bookListModule.controller("BookListCtrl",function(a,b,c,d){a.filterOptions={filterText:"",useExternalFilter:!0},a.totalServerItems=0,a.pagingOptions={pageSizes:[5,10,20],pageSize:5,currentPage:1},a.setPagingData=function(b,c,d){var e=b.slice((c-1)*d,c*d);a.books=e,a.totalServerItems=b.length,a.$$phase||a.$apply()},a.getPagedDataAsync=function(b,e,f){setTimeout(function(){var g;if(f){var h=f.toLowerCase();d.get("../data/books"+c.bookType+".json").success(function(c){g=c.filter(function(a){return-1!=JSON.stringify(a).toLowerCase().indexOf(h)}),a.setPagingData(g,e,b)})}else d.get("../data/books"+c.bookType+".json").success(function(c){a.setPagingData(c,e,b)})},100)},a.getPagedDataAsync(a.pagingOptions.pageSize,a.pagingOptions.currentPage),a.$watch("pagingOptions",function(b,c){b!==c&&b.currentPage!==c.currentPage&&a.getPagedDataAsync(a.pagingOptions.pageSize,a.pagingOptions.currentPage,a.filterOptions.filterText)},!0),a.$watch("filterOptions",function(b,c){b!==c&&a.getPagedDataAsync(a.pagingOptions.pageSize,a.pagingOptions.currentPage,a.filterOptions.filterText)},!0),a.gridOptions={data:"books",rowTemplate:'<div style="height: 100%"><div ng-style="{ \'cursor\': row.cursor }" ng-repeat="col in renderedColumns" ng-class="col.colIndex()" class="ngCell "><div class="ngVerticalBar" ng-style="{height: rowHeight}" ng-class="{ ngVerticalBarVisible: !$last }"> </div><div ng-cell></div></div></div>',multiSelect:!1,enableCellSelection:!0,enableRowSelection:!1,enableCellEdit:!0,enablePinning:!0,columnDefs:[{field:"index",displayName:"ID",width:60,pinnable:!1,sortable:!1},{field:"name",displayName:"Book Name",enableCellEdit:!0},{field:"author",displayName:"Author",enableCellEdit:!0,width:220},{field:"pubTime",displayName:"Publish Date",enableCellEdit:!0,width:120},{field:"price",displayName:"Price",enableCellEdit:!0,width:120,cellFilter:'currency:"$"'},{field:"bookId",displayName:"Operation",enableCellEdit:!1,sortable:!1,pinnable:!1,cellTemplate:'<div><a ui-sref="bookdetail({bookType: $stateParams.bookType, bookId:row.getProperty(col.field)})" id="{{row.getProperty(col.field)}}">Detail</a></div>'}],enablePaging:!0,showFooter:!0,totalServerItems:"totalServerItems",pagingOptions:a.pagingOptions,filterOptions:a.filterOptions}});var bookDetailModule=angular.module("BookDetailModule",[]);bookDetailModule.controller("BookDetailCtrl",function(a,b,c,d){d.get("../data/books"+c.bookType+".json").success(function(b){a.book=b[c.bookId-1]})}),bookListModule.factory("bookStoreService",function(a){var b={};return b.get=function(b){return a.get(b)},b});